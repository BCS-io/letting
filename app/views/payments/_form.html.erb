<%= form_for payment do |payment_form| %>
  <%= render 'shared/errors', object: payment.source %>

  <fieldset id='payment' class='grid  shell  overlay-parent'>
    <div class='col-6-24  grid-row'>
      <h2>Property</h2>
      <h1>ID: <%= payment.human_ref %></h1>
    </div>
    <div class='col-9-24'>
      <br>
      <br>
      <% if payment.account_exists? %>
        <%= render 'addresses/abridged', property: payment.property_decorator %>
      <% end %>
    </div>
    <div class='col-9-24  shell'>
      <h4>Payment Summary</h4>
      <div class='col-6-12  grid-row'>
        Last Property&nbsp;(<%= payment.last_human_ref %>)
      </div>
      <div class='col-6-12  r-align'>
        <%= link_to payment.last_amount, edit_payment_path(Payments.last), class: 'hover-link'%>
      </div>
      <div class='col-6-12  grid-row'>
        Day's Total
      </div>
      <div class='col-6-12  r-align'>
        <%= link_to payment.todays_takings, payments_path, class: 'hover-link' %>
      </div>
    </div>
    <% if payment.account_exists? %>
      <hr>
      <h2>Payment Received</h2>
      <div class='col-6-24  grid-row  grid-header'>Type</div>
      <div class='col-9-24  grid-header'>Booked On</div>
      <div class='col-1-24  grid-header  pick-out'>&nbsp;</div>
      <div class='col-8-24  grid-header  pick-out'>Payment Amount</div>

      <div class='col-6-24  grid-row cell'><%= payment_form.label 'Cheque' %></div>
      <div class='col-9-24  cell'><%= payment_form.date_field :booked_on %></div>
      <div class='col-1-24  cell  pick-out'>&nbsp;</div>
      <div class='col-8-24  cell  pick-out'>
        <%= payment_form.hidden_field :account_id %>
        <%= payment_form.submit name: 'submit', id: 'submit', autofocus:true , class: 'plain-button' %>
      </div>
      <div class='js-totalizer'>
        <%= render 'credits/form', payment: payment, payment_form: payment_form %>
        <div class='col-12-24  grid-row'>&nbsp;</div>
        <div class='col-3-24  cell  r-align'><h3>Total</h3></div>
        <div class='col-1-24  cell  pick-out'>&nbsp;</div>
        <div class='col-7-24  cell  pick-out  r-align'>
          <%= payment_form.text_field :amount, value: number_with_precision(payment_form.object.amount, precision: 2), readonly: true, class: 'js-total-payment  r-align  width-1-1' %>
        </div>
        <div class='col-1-24  cell  pick-out'>&nbsp;</div>
      </div>
    <% else %>
      <%= render 'teachings/payment' %>
    <% end %>
  </fieldset>
<% end %>
