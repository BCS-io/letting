<div class='js-toggle-selection'>
  <div class='col-1-1 faded'>
    <h3>Charges</h3>
  </div>
  <div class='col-6-24 vertical-spacer grid-header'>
    Charge
  </div>
  <div class='col-5-24 vertical-spacer grid-header'>
    Cycle
  </div>
  <div class='col-3-24 vertical-spacer grid-header'>
    Payment
  </div>
  <div class='col-3-24 vertical-spacer grid-header r-align'>
    Amount
  </div>
  <div class='col-7-24 vertical-spacer grid-header'>
    Dormant
  </div>
  <% charges.each.with_index do |charge,index| %>
    <%= builder.fields_for :charges, charge do |f| %>
        <div id='property_charge_<%= index %>' class='js-selection <%= hide_new_record_unless_first charge, index %>'  >
          <div class='grid js-dynamic-group'>
            <div class='col-6-24 vertical-spacer  no-r-pad spec-charge-count'>
              <%= f.text_field :charge_type, data: { autocomplete_source: Charge.uniq.pluck(:charge_type).sort } %>
            </div>
            <div class='col-5-24 vertical-spacer'>
              <%= f.select :charge_cycle_id, options_for_select( ChargeCycleDecorator.all, charge.charge_cycle_id ), { prompt: 'Please select'},{ class: 'js-dynamic-filter' } %>
            </div>
            <div class='col-3-24 vertical-spacer'>
              <%= f.grouped_collection_select :charged_in_id, ChargeCycle.all, :charged_ins, :name, :id, :name, { include_blank: true }, { class: 'js-dynamic-result' } %>
            </div>
            <div class='col-3-24 vertical-spacer r-align'>
              <%= f.text_field :amount, class: 'r-align' %>
              <%= f.hidden_field :start_date %>
              <%= f.hidden_field :end_date %>
            </div>
            <div class='col-7-24 vertical-spacer'>
              <%= f.check_box :dormant, class: 'js-checkbox-toggle' %>
            </div>
          </div>
        </div>
    <% end %>
  <% end %>
  <%= link_to fa_icon('plus lg'), '#', class: 'js-reveal-link', title: 'Add Charge' %>
</div>